
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Utility functions &#8212; Hat Core Documentation  documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Parsing expression grammar" href="peg.html" />
    <link rel="prev" title="Libraries" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="peg.html" title="Parsing expression grammar"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Libraries"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Hat Core Documentation  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Libraries</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="utility-functions">
<h1>Utility functions<a class="headerlink" href="#utility-functions" title="Permalink to this headline">¶</a></h1>
<p>Functions used across different modules, included in Hat project, not available
in standard library.</p>
<div class="section" id="module-hat.util.common">
<span id="python-implementation"></span><h2>Python implementation<a class="headerlink" href="#module-hat.util.common" title="Permalink to this headline">¶</a></h2>
<p>Common utility functions</p>
<dl class="py function">
<dt id="hat.util.common.first">
<code class="sig-prename descclassname">hat.util.common.</code><code class="sig-name descname">first</code><span class="sig-paren">(</span><em class="sig-param">xs</em>, <em class="sig-param">fn=&lt;function &lt;lambda&gt;&gt;</em>, <em class="sig-param">default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.common.first" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first element from iterable that satisfies predicate <cite>fn</cite>,
or <cite>default</cite> if no such element exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs</strong> (<em>Iterable</em><em>[</em><em>Any</em><em>]</em>) – collection</p></li>
<li><p><strong>fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>Any</em><em>]</em><em>,</em><em>bool</em><em>]</em>) – predicate</p></li>
<li><p><strong>default</strong> (<em>Any</em>) – default</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.common.namedtuple">
<code class="sig-prename descclassname">hat.util.common.</code><code class="sig-name descname">namedtuple</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">field_props</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.common.namedtuple" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a documented Type[collections.namedtuple]`.</p>
<p>The <cite>name</cite> can be a string; or a tuple containing name and documentation.</p>
<p>The <cite>field_props</cite> are an iterable of tuple field properties. A property
can be a field name; a tuple of field name and documentation; or a tuple
of field name, documentation and default value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>Union</em><em>[</em><em>str</em><em>,</em><em>Tuple</em><em>[</em><em>str</em><em>,</em><em>str</em><em>]</em><em>]</em>) – tuple name with optional documentation</p></li>
<li><p><strong>field_props</strong> (<em>Iterable</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>,</em><em>Tuple</em><em>[</em><em>str</em><em>,</em><em>str</em><em>]</em><em>,</em><em>Tuple</em><em>[</em><em>str</em><em>,</em><em>str</em><em>,</em><em>Any</em><em>]</em><em>]</em><em>]</em>) – tuple field properties</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Type[collections.namedtuple]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.common.extend_enum_doc">
<code class="sig-prename descclassname">hat.util.common.</code><code class="sig-name descname">extend_enum_doc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cls</span></em>, <em class="sig-param"><span class="n">description</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.common.extend_enum_doc" title="Permalink to this definition">¶</a></dt>
<dd><p>Extend enumeration documentation with a list of all members.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cls</strong> (<em>enum.EnumMeta</em>) – enumeration class</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>enum.EnumMeta</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="hat.util.common.RegisterCallbackHandle">
<em class="property">class </em><code class="sig-prename descclassname">hat.util.common.</code><code class="sig-name descname">RegisterCallbackHandle</code><a class="headerlink" href="#hat.util.common.RegisterCallbackHandle" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hat.util.common.RegisterCallbackHandle" title="hat.util.common.RegisterCallbackHandle"><code class="xref py py-class docutils literal notranslate"><span class="pre">hat.util.common.RegisterCallbackHandle</span></code></a></p>
<p>Handle for canceling callback registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cancel</strong> (<em>Callable</em><em>[</em><em>[</em><em>]</em><em>,</em><em>None</em><em>]</em>) – cancel callback registration</p>
</dd>
</dl>
<p>Create new instance of RegisterCallbackHandle(cancel,)</p>
</dd></dl>

<dl class="py class">
<dt id="hat.util.common.CallbackRegistry">
<em class="property">class </em><code class="sig-prename descclassname">hat.util.common.</code><code class="sig-name descname">CallbackRegistry</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">exception_cb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.common.CallbackRegistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Registry that enables callback registration and notification.</p>
<p>Callbacks in the registry are notified sequentially with
<a class="reference internal" href="#hat.util.common.CallbackRegistry.notify" title="hat.util.common.CallbackRegistry.notify"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CallbackRegistry.notify()</span></code></a>. If a callback raises an exception, the
exception is caught and <cite>exception_cb</cite> handler is called. Notification of
subsequent callbacks is not interrupted. If handler is <cite>None</cite>, the
exception is reraised and no subsequent callback is notified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>exception_cb</strong> (<a class="reference internal" href="peg.html#hat.peg.Optional" title="hat.peg.Optional"><em>Optional</em></a><em>[</em><em>Callable</em><em>[</em><em>[</em><em>Exception</em><em>]</em><em>,</em><em>None</em><em>]</em><em>]</em>) – exception handler</p>
</dd>
</dl>
<dl class="py method">
<dt id="hat.util.common.CallbackRegistry.register">
<code class="sig-name descname">register</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cb</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.common.CallbackRegistry.register" title="Permalink to this definition">¶</a></dt>
<dd><p>Register a callback. A handle for registration canceling is
returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cb</strong> (<em>Callable</em>) – callback</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RegisterCallbackHandle</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.common.CallbackRegistry.notify">
<code class="sig-name descname">notify</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.common.CallbackRegistry.notify" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify all registered callbacks.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="hat.util.common.parse_url_query">
<code class="sig-prename descclassname">hat.util.common.</code><code class="sig-name descname">parse_url_query</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">query</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.common.parse_url_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse url query string.</p>
<p>Returns a dictionary of field names and their values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query</strong> (<em>str</em>) – url query string</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dict[str,str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.common.parse_env_path">
<code class="sig-prename descclassname">hat.util.common.</code><code class="sig-name descname">parse_env_path</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.common.parse_env_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse path with environment variables.</p>
<p>Parse file path and replace all file path segments equal to <code class="docutils literal notranslate"><span class="pre">$&lt;name&gt;</span></code>
with value of <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code> environment variable. If environment variable is
not set, segments are replaced with <code class="docutils literal notranslate"><span class="pre">.</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>os.PathLike</em>) – file path</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pathlib.Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="hat.util.common.LogRotatingFileHandler">
<em class="property">class </em><code class="sig-prename descclassname">hat.util.common.</code><code class="sig-name descname">LogRotatingFileHandler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">vargs</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.common.LogRotatingFileHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">logging.handlers.RotatingFileHandler</span></code></p>
<p>Filename is parsed with <a class="reference internal" href="#hat.util.common.parse_env_path" title="hat.util.common.parse_env_path"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_env_path()</span></code></a>.</p>
<p>For other arguments, see:
<code class="xref py py-class docutils literal notranslate"><span class="pre">logging.handlers.RotatingFileHandler</span></code>.</p>
</dd></dl>

<dl class="py class">
<dt id="hat.util.common.EnvPathArgParseAction">
<em class="property">class </em><code class="sig-prename descclassname">hat.util.common.</code><code class="sig-name descname">EnvPathArgParseAction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">option_strings</span></em>, <em class="sig-param"><span class="n">dest</span></em>, <em class="sig-param"><span class="n">nargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">const</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">default</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">choices</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">required</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">help</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">metavar</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.common.EnvPathArgParseAction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">argparse.Action</span></code></p>
<p>Argparse action for parsing file paths with environment variables.</p>
<p>Each path is parsed with <a class="reference internal" href="#hat.util.common.parse_env_path" title="hat.util.common.parse_env_path"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_env_path()</span></code></a>.</p>
</dd></dl>

<span class="target" id="module-hat.util.aio"></span><p>Async utility functions</p>
<dl class="py attribute">
<dt id="hat.util.aio.mlog">
<code class="sig-prename descclassname">hat.util.aio.</code><code class="sig-name descname">mlog</code><a class="headerlink" href="#hat.util.aio.mlog" title="Permalink to this definition">¶</a></dt>
<dd><p>module logger</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.aio.first">
<em class="property">async </em><code class="sig-prename descclassname">hat.util.aio.</code><code class="sig-name descname">first</code><span class="sig-paren">(</span><em class="sig-param">xs</em>, <em class="sig-param">fn=&lt;function &lt;lambda&gt;&gt;</em>, <em class="sig-param">default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.first" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>COROUTINE</strong>
Return the first element from async iterable that satisfies
predicate <cite>fn</cite>, or <cite>default</cite> if no such element exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs</strong> (<em>AsyncIterable</em><em>[</em><em>Any</em><em>]</em>) – async collection</p></li>
<li><p><strong>fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>Any</em><em>]</em><em>,</em><em>bool</em><em>]</em>) – predicate</p></li>
<li><p><strong>default</strong> (<em>Any</em>) – default</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.aio.uncancellable">
<em class="property">async </em><code class="sig-prename descclassname">hat.util.aio.</code><code class="sig-name descname">uncancellable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em>, <em class="sig-param"><span class="n">raise_cancel</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.uncancellable" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>COROUTINE</strong>
Uncancellable execution of a Future.</p>
<p>Future is shielded and its execution cannot be interrupted.</p>
<p>If <cite>raise_cancel</cite> is <cite>True</cite> and the Future gets canceled,
<code class="xref py py-exc docutils literal notranslate"><span class="pre">asyncio.CancelledError</span></code> is reraised after the Future finishes.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <cite>raise_cancel</cite> is <cite>False</cite>, this method suppresses
<code class="xref py py-exc docutils literal notranslate"><span class="pre">asyncio.CancelledError</span></code> and stops its propagation. Use with
caution.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>asyncio.Future</em>) – future</p></li>
<li><p><strong>raise_cancel</strong> (<em>bool</em>) – raise CancelledError flag</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>result</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.aio.call">
<em class="property">async </em><code class="sig-prename descclassname">hat.util.aio.</code><code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fn</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.call" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>COROUTINE</strong>
Call a function or a coroutine.</p>
<p>Call a <cite>fn</cite> with <cite>args</cite> and <cite>kwargs</cite>. If <cite>fn</cite> is a coroutine, it is
awaited.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> (<em>Callable</em>) – function or coroutine</p></li>
<li><p><strong>args</strong> – additional function arguments</p></li>
<li><p><strong>kwargs</strong> – additional function keyword arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>function result</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.aio.call_on_cancel">
<em class="property">async </em><code class="sig-prename descclassname">hat.util.aio.</code><code class="sig-name descname">call_on_cancel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fn</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.call_on_cancel" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>COROUTINE</strong>
Call a function or a coroutine when canceled.</p>
<p>When canceled, <cite>fn</cite> is called with <cite>args</cite> and <cite>kwargs</cite>. If <cite>fn</cite> is a
coroutine, it is awaited.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> (<em>Callable</em>) – function or coroutine</p></li>
<li><p><strong>args</strong> – additional function arguments</p></li>
<li><p><strong>kwargs</strong> – additional function keyword arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>function result</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.aio.create_executor">
<code class="sig-prename descclassname">hat.util.aio.</code><code class="sig-name descname">create_executor</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">executor_cls=&lt;class 'concurrent.futures.thread.ThreadPoolExecutor'&gt;</em>, <em class="sig-param">loop=None</em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.create_executor" title="Permalink to this definition">¶</a></dt>
<dd><p>Create <code class="xref py py-meth docutils literal notranslate"><span class="pre">asyncio.loop.run_in_executor()</span></code> wrapper.</p>
<p>Returns a coroutine that takes a function and its arguments, executes the
function using executor created from <cite>executor_cls</cite> and <cite>args</cite>; and
returns the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>Any</em>) – executor args</p></li>
<li><p><strong>executor_cls</strong> (<em>Type</em>) – executor class</p></li>
<li><p><strong>loop</strong> (<a class="reference internal" href="peg.html#hat.peg.Optional" title="hat.peg.Optional"><em>Optional</em></a><em>[</em><em>asyncio.AbstractEventLoop</em><em>]</em>) – asyncio loop</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>executor coroutine</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Coroutine[[Callable,..],Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.aio.init_asyncio">
<code class="sig-prename descclassname">hat.util.aio.</code><code class="sig-name descname">init_asyncio</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.init_asyncio" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize asyncio.</p>
<p>Sets event loop policy to <code class="xref py py-class docutils literal notranslate"><span class="pre">uvloop.EventLoopPolicy</span></code> if possible.</p>
<p>On Windows, sets policy to <code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.WindowsProactorEventLoopPolicy</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt id="hat.util.aio.run_asyncio">
<code class="sig-prename descclassname">hat.util.aio.</code><code class="sig-name descname">run_asyncio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">future</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.run_asyncio" title="Permalink to this definition">¶</a></dt>
<dd><p>Run asyncio loop until the <cite>future</cite> is completed and return the result.</p>
<p>SIGINT and SIGTERM handlers are temporarily overridden. Instead of raising
<code class="docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code> on every signal reception, Future is canceled only
once. Additional signals are ignored.</p>
<p>On Windows, SIGBREAK (CTRL_BREAK_EVENT) handler is also overridden and
asyncio loop gets periodically woken up (every 0.5 seconds).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>future</strong> (<em>Awaitable</em>) – future or coroutine</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>result</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt id="hat.util.aio.QueueClosedError">
<em class="property">exception </em><code class="sig-prename descclassname">hat.util.aio.</code><code class="sig-name descname">QueueClosedError</code><a class="headerlink" href="#hat.util.aio.QueueClosedError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Raised when trying to use a closed queue.</p>
</dd></dl>

<dl class="py exception">
<dt id="hat.util.aio.QueueEmptyError">
<em class="property">exception </em><code class="sig-prename descclassname">hat.util.aio.</code><code class="sig-name descname">QueueEmptyError</code><a class="headerlink" href="#hat.util.aio.QueueEmptyError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Raised if queue is empty.</p>
</dd></dl>

<dl class="py exception">
<dt id="hat.util.aio.QueueFullError">
<em class="property">exception </em><code class="sig-prename descclassname">hat.util.aio.</code><code class="sig-name descname">QueueFullError</code><a class="headerlink" href="#hat.util.aio.QueueFullError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Raised if queue is full.</p>
</dd></dl>

<dl class="py class">
<dt id="hat.util.aio.Queue">
<em class="property">class </em><code class="sig-prename descclassname">hat.util.aio.</code><code class="sig-name descname">Queue</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">maxsize</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Asyncio queue which implements AsyncIterable and can be closed.</p>
<p>Interface and implementation are based on <code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.Queue</span></code>.</p>
<p>If <cite>maxsize</cite> is less than or equal to zero, the queue size is infinite.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>maxsize</strong> (<em>int</em>) – maximum number of items in the queue</p>
</dd>
</dl>
<dl class="py method">
<dt id="hat.util.aio.Queue.maxsize">
<em class="property">property </em><code class="sig-name descname">maxsize</code><a class="headerlink" href="#hat.util.aio.Queue.maxsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of items in the queue.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Queue.closed">
<em class="property">property </em><code class="sig-name descname">closed</code><a class="headerlink" href="#hat.util.aio.Queue.closed" title="Permalink to this definition">¶</a></dt>
<dd><p>Closed future.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>asyncio.Future</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Queue.empty">
<code class="sig-name descname">empty</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Queue.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: <cite>True</cite> if queue is empty, <cite>False</cite> otherwise.</p>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Queue.full">
<code class="sig-name descname">full</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Queue.full" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: <cite>True</cite> if queue is full, <cite>False</cite> otherwise.</p>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Queue.qsize">
<code class="sig-name descname">qsize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Queue.qsize" title="Permalink to this definition">¶</a></dt>
<dd><p>int: Number of items currently in the queue.</p>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Queue.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Queue.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the queue.</p>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Queue.get_nowait">
<code class="sig-name descname">get_nowait</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Queue.get_nowait" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an item if one is immediately available, else raise
<a class="reference internal" href="#hat.util.aio.QueueEmptyError" title="hat.util.aio.QueueEmptyError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">QueueEmptyError</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#hat.util.aio.QueueEmptyError" title="hat.util.aio.QueueEmptyError"><strong>QueueEmptyError</strong></a> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Queue.put_nowait">
<code class="sig-name descname">put_nowait</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Queue.put_nowait" title="Permalink to this definition">¶</a></dt>
<dd><p>Put an item into the queue without blocking.</p>
<p>If no free slot is immediately available, raise <a class="reference internal" href="#hat.util.aio.QueueFullError" title="hat.util.aio.QueueFullError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">QueueFullError</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>item</strong> (<em>Any</em>) – item</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#hat.util.aio.QueueFullError" title="hat.util.aio.QueueFullError"><strong>QueueFullError</strong></a> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Queue.get">
<em class="property">async </em><code class="sig-name descname">get</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Queue.get" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>COROUTINE</strong>
Remove and return an item from the queue.</p>
<p>If queue is empty, wait until an item is available.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#hat.util.aio.QueueClosedError" title="hat.util.aio.QueueClosedError"><strong>QueueClosedError</strong></a> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Queue.put">
<em class="property">async </em><code class="sig-name descname">put</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Queue.put" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>COROUTINE</strong>
Put an item into the queue.</p>
<p>If the queue is full, wait until a free slot is available before adding
the item.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>item</strong> (<em>Any</em>) – item</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#hat.util.aio.QueueClosedError" title="hat.util.aio.QueueClosedError"><strong>QueueClosedError</strong></a> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Queue.get_until_empty">
<em class="property">async </em><code class="sig-name descname">get_until_empty</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Queue.get_until_empty" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>COROUTINE</strong>
Empty the queue and return the last item.</p>
<p>If queue is empty, wait until at least one item is available.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#hat.util.aio.QueueClosedError" title="hat.util.aio.QueueClosedError"><strong>QueueClosedError</strong></a> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Queue.get_nowait_until_empty">
<code class="sig-name descname">get_nowait_until_empty</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Queue.get_nowait_until_empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Empty the queue and return the last item if at least one
item is immediately available, else raise <a class="reference internal" href="#hat.util.aio.QueueEmptyError" title="hat.util.aio.QueueEmptyError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">QueueEmptyError</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#hat.util.aio.QueueEmptyError" title="hat.util.aio.QueueEmptyError"><strong>QueueEmptyError</strong></a> – </p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hat.util.aio.Group">
<em class="property">class </em><code class="sig-prename descclassname">hat.util.aio.</code><code class="sig-name descname">Group</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">exception_cb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">loop</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Group" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Group of asyncio Tasks.</p>
<p>Group enables creation and management of related asyncio Tasks. The
Group ensures uninterrupted execution of Tasks and Task completion upon
Group closing.</p>
<p>Group can contain subgroups, which are independent Groups managed by the
parent Group.</p>
<p>If a Task raises exception, other Tasks continue to execute.</p>
<p>If <cite>exception_cb</cite> handler is <cite>None</cite>, exceptions are logged with level
WARNING.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exception_cb</strong> (<a class="reference internal" href="peg.html#hat.peg.Optional" title="hat.peg.Optional"><em>Optional</em></a><em>[</em><em>Callable</em><em>[</em><em>[</em><em>Exception</em><em>]</em><em>,</em><em>None</em><em>]</em><em>]</em>) – exception handler</p></li>
<li><p><strong>loop</strong> (<a class="reference internal" href="peg.html#hat.peg.Optional" title="hat.peg.Optional"><em>Optional</em></a><em>[</em><em>asyncio.AbstractEventLoop</em><em>]</em>) – asyncio loop</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="hat.util.aio.Group.is_open">
<em class="property">property </em><code class="sig-name descname">is_open</code><a class="headerlink" href="#hat.util.aio.Group.is_open" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>True</cite> if group is not closing or closed, <cite>False</cite> otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Group.closing">
<em class="property">property </em><code class="sig-name descname">closing</code><a class="headerlink" href="#hat.util.aio.Group.closing" title="Permalink to this definition">¶</a></dt>
<dd><p>Closing Future.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>asyncio.Future</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Group.closed">
<em class="property">property </em><code class="sig-name descname">closed</code><a class="headerlink" href="#hat.util.aio.Group.closed" title="Permalink to this definition">¶</a></dt>
<dd><p>Closed Future.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>asyncio.Future</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Group.create_subgroup">
<code class="sig-name descname">create_subgroup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Group.create_subgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new Group as a child of this Group. Return the new Group.</p>
<p>When a parent Group gets closed, all of its children are closed.
Closing of a subgroup has no effect on the parent Group.</p>
<p>Subgroup inherits exception handler from its parent.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Group.wrap">
<code class="sig-name descname">wrap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">future</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Group.wrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap the Future into a Task and schedule its execution. Return the
Task object.</p>
<p>Resulting task is shielded and can be canceled only with
<a class="reference internal" href="#hat.util.aio.Group.async_close" title="hat.util.aio.Group.async_close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Group.async_close()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>future</strong> (<em>asyncio.Future</em>) – future</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>asyncio.Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Group.spawn">
<code class="sig-name descname">spawn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fn</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Group.spawn" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap the result of a <cite>fn</cite> into a Task and schedule its execution.
Return the Task object.</p>
<p>Function is called with provided <cite>args</cite> and <cite>kwargs</cite>.
Resulting Task is shielded and can be canceled only with
<a class="reference internal" href="#hat.util.aio.Group.async_close" title="hat.util.aio.Group.async_close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Group.async_close()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>..</em><em>]</em><em>,</em><em>Awaitable</em><em>]</em>) – function</p></li>
<li><p><strong>args</strong> – function arguments</p></li>
<li><p><strong>kwargs</strong> – function keyword arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>asyncio.Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Group.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cancel</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Group.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Schedule Group closing.</p>
<p>Closing Future is set immediately. All subgroups are closed, and all
running tasks are optionally canceled. Once closing of all subgroups
and execution of all tasks is completed, closed Future is set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cancel</strong> (<em>bool</em>) – cancel running tasks</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.aio.Group.async_close">
<em class="property">async </em><code class="sig-name descname">async_close</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cancel</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.aio.Group.async_close" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>COROUTINE</strong>
Close Group and wait until closed Future is completed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cancel</strong> (<em>bool</em>) – cancel running tasks</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-hat.util.json"></span><p>JSON data manipulation and validation</p>
<dl class="py attribute">
<dt id="hat.util.json.Data">
<code class="sig-prename descclassname">hat.util.json.</code><code class="sig-name descname">Data</code><a class="headerlink" href="#hat.util.json.Data" title="Permalink to this definition">¶</a></dt>
<dd><p>JSON data type identifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Type</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="hat.util.json.Format">
<em class="property">class </em><code class="sig-prename descclassname">hat.util.json.</code><code class="sig-name descname">Format</code><a class="headerlink" href="#hat.util.json.Format" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>An enumeration.</p>
<ul class="simple">
<li><p>JSON</p></li>
<li><p>YAML</p></li>
</ul>
<dl class="py attribute">
<dt id="hat.util.json.Format.JSON">
<code class="sig-name descname">JSON</code><em class="property"> = 1</em><a class="headerlink" href="#hat.util.json.Format.JSON" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hat.util.json.Format.YAML">
<code class="sig-name descname">YAML</code><em class="property"> = 2</em><a class="headerlink" href="#hat.util.json.Format.YAML" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="hat.util.json.equals">
<code class="sig-prename descclassname">hat.util.json.</code><code class="sig-name descname">equals</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.json.equals" title="Permalink to this definition">¶</a></dt>
<dd><p>Equality comparison of json serializable data.</p>
<p>Tests for equality of data according to JSON format. Notably, <code class="docutils literal notranslate"><span class="pre">bool</span></code>
values are not considered equal to numeric values in any case. This is
different from default equality comparison, which considers <cite>False</cite>
equal to <cite>0</cite> and <cite>0.0</cite>; and <cite>True</cite> equal to <cite>1</cite> and <cite>1.0</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>Data</em>) – data</p></li>
<li><p><strong>b</strong> (<em>Data</em>) – data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.json.diff">
<code class="sig-prename descclassname">hat.util.json.</code><code class="sig-name descname">diff</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">src</span></em>, <em class="sig-param"><span class="n">dst</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.json.diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate JSON Patch diff.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> (<em>Data</em>) – data</p></li>
<li><p><strong>dst</strong> (<em>Data</em>) – data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.json.patch">
<code class="sig-prename descclassname">hat.util.json.</code><code class="sig-name descname">patch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">diff</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.json.patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply JSON Patch diff.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – data</p></li>
<li><p><strong>diff</strong> (<em>Data</em>) – diff</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.json.encode">
<code class="sig-prename descclassname">hat.util.json.</code><code class="sig-name descname">encode</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">format=&lt;Format.JSON: 1&gt;</em>, <em class="sig-param">indent=None</em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.json.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode JSON data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – JSON data</p></li>
<li><p><strong>format</strong> (<a class="reference internal" href="#hat.util.json.Format" title="hat.util.json.Format"><em>Format</em></a>) – encoding format</p></li>
<li><p><strong>indent</strong> (<a class="reference internal" href="peg.html#hat.peg.Optional" title="hat.peg.Optional"><em>Optional</em></a><em>[</em><em>int</em><em>]</em>) – indentation size</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.json.decode">
<code class="sig-prename descclassname">hat.util.json.</code><code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param">data_str</em>, <em class="sig-param">format=&lt;Format.JSON: 1&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.json.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode JSON data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_str</strong> (<em>str</em>) – encoded JSON data</p></li>
<li><p><strong>format</strong> (<a class="reference internal" href="#hat.util.json.Format" title="hat.util.json.Format"><em>Format</em></a>) – encoding format</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.json.encode_file">
<code class="sig-prename descclassname">hat.util.json.</code><code class="sig-name descname">encode_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">format</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">indent</span><span class="o">=</span><span class="default_value">4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.json.encode_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode JSON data to file.</p>
<p>If format is <cite>None</cite>, encoding format is derived from path suffix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – JSON data</p></li>
<li><p><strong>path</strong> (<em>pathlib.PurePath</em>) – file path</p></li>
<li><p><strong>format</strong> (<a class="reference internal" href="peg.html#hat.peg.Optional" title="hat.peg.Optional"><em>Optional</em></a><em>[</em><a class="reference internal" href="#hat.util.json.Format" title="hat.util.json.Format"><em>Format</em></a><em>]</em>) – encoding format</p></li>
<li><p><strong>indent</strong> (<a class="reference internal" href="peg.html#hat.peg.Optional" title="hat.peg.Optional"><em>Optional</em></a><em>[</em><em>int</em><em>]</em>) – indentation size</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hat.util.json.decode_file">
<code class="sig-prename descclassname">hat.util.json.</code><code class="sig-name descname">decode_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">format</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.json.decode_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode JSON data from file.</p>
<p>If format is <cite>None</cite>, encoding format is derived from path suffix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>pathlib.PurePath</em>) – file path</p></li>
<li><p><strong>format</strong> (<a class="reference internal" href="peg.html#hat.peg.Optional" title="hat.peg.Optional"><em>Optional</em></a><em>[</em><a class="reference internal" href="#hat.util.json.Format" title="hat.util.json.Format"><em>Format</em></a><em>]</em>) – encoding format</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Data</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="hat.util.json.SchemaRepository">
<em class="property">class </em><code class="sig-prename descclassname">hat.util.json.</code><code class="sig-name descname">SchemaRepository</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.json.SchemaRepository" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>JSON Schema repository.</p>
<p>A repository that holds json schemas and enables validation against them.</p>
<p>Repository can be initialized with multiple arguments, which can be
instances of <code class="docutils literal notranslate"><span class="pre">pathlib.PurePath</span></code>, <code class="docutils literal notranslate"><span class="pre">Data</span></code> or <code class="docutils literal notranslate"><span class="pre">SchemaRepository</span></code>.</p>
<p>If an argument is of type <code class="docutils literal notranslate"><span class="pre">pathlib.PurePath</span></code>, and path points to file
with a suffix ‘.json’, ‘.yml’ or ‘.yaml’, json serializable data is decoded
from the file. Otherwise, it is assumed that path points to a directory,
which is recursively searched for json and yaml files. All decoded schemas
are added to the repository. If a schema with the same <cite>id</cite> was previosly
added, an exception is raised.</p>
<p>If an argument is of type <code class="docutils literal notranslate"><span class="pre">Data</span></code>, it should be a json serializable data
representation of a JSON schema. If a schema with the same <cite>id</cite> was
previosly added, an exception is raised.</p>
<p>If an argument is of type <code class="docutils literal notranslate"><span class="pre">SchemaRepository</span></code>, its schemas are added to
the new repository. Previously added schemas with the same <cite>id</cite> are
replaced.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<em>Union</em><em>[</em><em>pathlib.PurePath</em><em>,</em><em>Data</em><em>,</em><a class="reference internal" href="#hat.util.json.SchemaRepository" title="hat.util.json.SchemaRepository"><em>SchemaRepository</em></a><em>]</em>) – init arguments</p>
</dd>
</dl>
<dl class="py method">
<dt id="hat.util.json.SchemaRepository.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">schema_id</span></em>, <em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.json.SchemaRepository.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate data against JSON schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema_id</strong> (<em>str</em>) – JSON schema identifier</p></li>
<li><p><strong>data</strong> (<em>Data</em>) – data to be validated</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>jsonschema.ValidationError</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.json.SchemaRepository.to_json">
<code class="sig-name descname">to_json</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.json.SchemaRepository.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Export repository content as json serializable data.</p>
<p>Entire repository content is exported as json serializable data.
New repository can be created from the exported content by using
<a class="reference internal" href="#hat.util.json.SchemaRepository.from_json" title="hat.util.json.SchemaRepository.from_json"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SchemaRepository.from_json()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hat.util.json.SchemaRepository.from_json">
<em class="property">static </em><code class="sig-name descname">from_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#hat.util.json.SchemaRepository.from_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new repository from content exported as json serializable
data.</p>
<p>Creates a new repository from content of another repository that was
exported by using <a class="reference internal" href="#hat.util.json.SchemaRepository.to_json" title="hat.util.json.SchemaRepository.to_json"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SchemaRepository.to_json()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Union</em><em>[</em><em>pathlib.PurePath</em><em>,</em><em>Data</em><em>]</em>) – repository data</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SchemaRepository</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Libraries</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Utility functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="peg.html">Parsing expression grammar</a></li>
<li class="toctree-l2"><a class="reference internal" href="sbs.html">Simple binary serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatter.html">Chatter communication protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="juggler.html">Juggler communication protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="duktape.html">Duktape wrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="drivers/index.html">Drivers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../components/index.html">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index.html">Appendix</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Libraries</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="peg.html"
                        title="next chapter">Parsing expression grammar</a></p>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="peg.html" title="Parsing expression grammar"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Libraries"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Hat Core Documentation  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Libraries</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Hat Open AUTHORS.
    </div>
  </body>
</html>